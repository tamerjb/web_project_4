!function(){"use strict";class e{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasValidInputs(){return this._inputList.every((e=>e.validity.valid))}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._button=this._form.querySelector(this._submitButtonSelector),this.toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButton()})),this.resetValidation()}))}toggleButton(){this._hasValidInputs()?(this._button.disabled=!1,this._button.classList.remove(this._inactiveButtonClass)):(this._button.disabled=!0,this._button.classList.add(this._inactiveButtonClass))}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}resetValidation(){this.toggleButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s,r,i){let{handleCardClick:n,handleCardDelete:o,handleLikeCard:a}=r;t(this,"_getCloneFromTemplate",(()=>document.querySelector(this._selector).content.querySelector(".card").cloneNode(!0))),t(this,"_setEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this._id)})),this._image.addEventListener("click",(()=>{this._handleCardClick(this._id)})),this._deleteButton.addEventListener("click",(()=>{this._handleCardDelete(this._id)}))})),this._text=e.name,this._link=e.link,this._selector=s,this._handleCardClick=n,this._handleCardDelete=o,this._handleLikeCard=a,this._id=e._id,this._userId=i,this._ownerId=e.owner._id,this._likes=e.likes}likeCard(e){this._likeButton.classList.add("card__like-button_active"),this._likes=e,this._likeCount.textContent=this._likes.length}dislikeCard(e){this._likeButton.classList.remove("card__like-button_active"),this._likes=e,this._likeCount.textContent=this._likes.length}isLiked(){return this._likes.some((e=>e._id===this._userId))}removeCard(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getCloneFromTemplate(),this._image=this._element.querySelector(".card__image"),this._element.querySelector(".card__info-title").textContent=this._text,this._image.src=this._link,this._image.alt="Place in ".concat(this._text),this._deleteButton=this._element.querySelector(".card__image-trash"),this._ownerId!==this._userId&&(this._deleteButton.style.display="none"),this._likeButton=this._element.querySelector(".card__like-button"),this._likeCount=this._element.querySelector(".card__like-count"),this._likeCount.textContent=this._likes.length,this.isLiked()&&this.likeCard(this._likes),this._setEventListeners(),this._element}}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class i{constructor(e){r(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),r(this,"_overlayClose",(e=>{e.target.classList.contains("popup")&&this.close()})),this._popupElement=document.querySelector(e),this.close=this.close.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._overlayClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("click",this._overlayClose)}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("click",(()=>{this.close()}))}}class n extends i{constructor(e,t){var s,r;super(e),r=()=>{super.close(),this._formElement.reset()},(s="close")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this._submitHandler=t,this._formElement=this._popupElement.querySelector(".popup__form"),this._inputs=[...this._formElement.querySelectorAll(".form__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]})),console.log(this._inputs)}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues()),this.close()})),super.setEventListeners()}}document.querySelector(".form");const o=document.querySelector(".profile"),a=(o.querySelector(".profile__name"),document.querySelector(".popup-edit-profile")),l=(o.querySelector(".profile__title"),form.querySelector(".form__input[name='name']"),form.querySelector(".form__input[name='title']"),document.querySelector(".cards").querySelector(".cards__list"),document.querySelector(".popup__form-type-add-place")),c=(l.querySelector(".form__input-type-place-name"),l.querySelector(".form__input-type-place-url"),document.querySelector(".popup-prev")),u=(c.querySelector(".popup__image"),c.querySelector(".popup__caption"),document.querySelector(".popup-place")),h=o.querySelector(".profile__edit-button"),_=o.querySelector(".profile__add-button"),d=(document.querySelectorAll(".popup__close-button"),document.querySelector(".profile__image-container")),p=document.querySelector(".popup__form_type_avatar"),m=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch((e=>console.log())),v=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return m("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return m("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}setUserInfo(e){let{name:t,about:s}=e;return console.log("test",{name:t,about:s}),m("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})})}createCard(e){return m("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return m("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}likeCard(e){return m("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}dislikeCard(e){return m("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}setUserAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"edde3a5c-b30d-40b0-99e9-6f72ee976ddf","Content-Type":"application/json"}}),f=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._profileName.textContent,about:this._profileJob.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._profileName.textContent=t,this._profileJob.textContent=s}setUserAvatar(e){this._avatar.src=e}setAvatarVisible(){this._avatar.style.visibility="visible"}}({nameSelector:".profile__name",jobSelector:".profile__title",avatarSelector:".profile__image"}),b=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:U},".cards__list");let C;Promise.all([v.getInitialCards(),v.getUserInfo()]).then((e=>{let[t,s]=e;C=s._id,b.renderItems(t),f.setUserInfo(s.name,s.title),f.setUserAvatar(s.avatar)})).then((()=>f.setAvatarVisible())).catch((e=>console.log(e)));const y=new class extends i{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".popup__image"),this._popupCaption=this._popupElement.querySelector(".popup__caption")}open(e,t){this._popupImage.src=e,this._popupImage.alt="A view of ".concat(t),this._popupCaption.textContent=t,super.open()}}(".popup-prev");y.setEventListeners();const E=new n(".popup-edit-profile",(e=>{console.log("data =>",e),v.setUserInfo({name:e.name,about:e.title}).then((e=>{f.getUserInfo(),f.setUserInfo({name:e.name,about:e.about}),E.close()})).catch((e=>console.log(e)))}));E.setEventListeners();const k={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input-error",errorClass:"form__input-error"},S=new e(k,a);S.enableValidation();const g=new e(k,u);g.enableValidation(),new e(k,p).enableValidation();const L=new n(".popup-place",(e=>{v.createCard(e).then((e=>{U(e),L.close()})).catch((e=>console.log(e)))})),q=new class extends i{setAction(e){this._submitHandler=e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}}(".popup-type-delete-card"),I=new n(".popup_type_avatar",(e=>{v.setUserAvatar(e.link).then((e=>{f.setUserAvatar(e.avatar),I.close()})).catch((e=>console.log(e)))}));function U(e){const t=function(e){const t=new s(e,"#card-template",{handleCardClick:()=>{y.open(e.link,e.name)},handleCardDelete:e=>{q.open(),q.setAction((()=>{v.deleteCard(e).then((e=>{t.removeCard()})).then((()=>{q.close()})).catch((e=>console.log(e)))}))},handleLikeCard:e=>{t.isLiked()?v.dislikeCard(e).then((e=>{t.dislikeCard(e.likes)})).catch((e=>console.log(e))):v.likeCard(e).then((e=>{t.likeCard(e.likes),console.log("res",e)})).catch((e=>console.log(e)))}},C);return t.generateCard()}(e);b.addItem(t)}L.setEventListeners(),q.setEventListeners(),I.setEventListeners(),h.addEventListener("click",(()=>{const e=f.getUserInfo();E.setInputValues(e),S.enableValidation(),S.toggleButton(),E.open()})),_.addEventListener("click",(()=>{L.open(),g.resetValidation()})),d.addEventListener("click",(()=>{I.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBQUEsU0FDWXhILEdBQ1QrRyxNQUFNQyxJQUNMZ0UsRUFBSzNILFNBQVMyRCxFQUFJNUQsT0FDbEIyQyxRQUFRQyxJQUFJLE1BQU9nQixNQUVwQk0sT0FBT0MsR0FBUXhCLFFBQVFDLElBQUl1QixPQWNwQzFGLEdBR0YsT0FEb0JtSixFQUFLakgsZUFRVEEsQ0FBYXBDLEdBQzdCdUgsRUFBY1EsUUFBUXFCLEdBcEV4QkwsRUFBYXhGLG9CQUNieUYsRUFBWXpGLG9CQUNaNEYsRUFBWTVGLG9CQXlFWnFCLEVBQWtCbkYsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTTZKLEVBQU94QyxFQUFTWixjQUN0QnlDLEVBQVV4RSxlQUFlbUYsR0FDekJULEVBQXFCakosbUJBQ3JCaUosRUFBcUJ0SixlQUNyQm9KLEVBQVV4RixVQUlaMEIsRUFBYXBGLGlCQUFpQixTQUFTLEtBQ3JDc0osRUFBYTVGLE9BQ2IyRixFQUFpQnBKLHFCQUduQm9GLEVBQU9yRixpQkFBaUIsU0FBUyxLQUUvQjBKLEVBQVloRyxVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWdzLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZ3MuZXJyb3JDbGFzcztcblxuICAgIH1cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICAgICAgLy8gYWRkIGVycm9yIG1zZy9jbGFzc1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICAgICAgLy8gaW5wdXQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKVxuICAgIH1cbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICAgICAgLy8gYWRkIGVycm9yIG1zZy9jbGFzc1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICAvLyBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuXG4gICAgfVxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpIHtcbiAgICAgICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuXG4gICAgICAgIH1cblxuICAgIH1cbiAgICBfaGFzVmFsaWRJbnB1dHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaW5wdXQudmFsaWRpdHkudmFsaWQ7XG4gICAgICAgIH0pXG5cbiAgICB9XG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKCk7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucmVzZXRWYWxpZGF0aW9uKCk7XG5cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRvZ2dsZUJ1dHRvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2hhc1ZhbGlkSW5wdXRzKCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIH1cblxuICAgIH1cbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IGUucHJldmVudERlZmF1bHQoKSk7XG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbigpOyAvLyA8PSA9IGNvbnRyb2xsaW5nIHRoZSBzdWJtaXQgYnV0dG9uID09XG5cbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCkgLy88PSA9IGNsZWFyaW5nIGVycm9ycyA9PVxuICAgICAgICB9KTtcblxuICAgIH1cblxufSIsImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgZGF0YSxcbiAgICAgICAgc2VsZWN0b3IsIHtcbiAgICAgICAgICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICAgICAgICAgIGhhbmRsZUNhcmREZWxldGUsXG4gICAgICAgICAgICBoYW5kbGVMaWtlQ2FyZCxcbiAgICAgICAgfSwgdXNlcklkXG4gICAgKSB7XG4gICAgICAgIHRoaXMuX3RleHQgPSBkYXRhLm5hbWU7XG4gICAgICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSA9IGhhbmRsZUNhcmREZWxldGU7XG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkID0gaGFuZGxlTGlrZUNhcmQ7XG4gICAgICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICAgICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xuICAgICAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgfVxuICAgIF9nZXRDbG9uZUZyb21UZW1wbGF0ZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3IpXG4gICAgICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgICB9XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG5cbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQodGhpcy5faWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5faW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9pZCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGUodGhpcy5faWQpO1xuXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgbGlrZUNhcmQobmV3TGlrZXMpIHtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgICAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xuICAgICAgICB0aGlzLl9saWtlQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgfVxuXG4gICAgZGlzbGlrZUNhcmQobmV3TGlrZXMpIHtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgICAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xuICAgICAgICB0aGlzLl9saWtlQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgfVxuICAgIGlzTGlrZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgICB9XG5cbiAgICByZW1vdmVDYXJkKCkge1xuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcblxuICAgIH1cbiAgICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRDbG9uZUZyb21UZW1wbGF0ZSgpO1xuICAgICAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcblxuXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbmZvLXRpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcbiAgICAgICAgdGhpcy5faW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gYFBsYWNlIGluICR7dGhpcy5fdGV4dH1gO1xuXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZS10cmFzaFwiKTtcblxuXG4gICAgICAgIHRoaXMuX293bmVySWQgIT09IHRoaXMuX3VzZXJJZCAmJlxuICAgICAgICAgICAgKHRoaXMuX2RlbGV0ZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCIpO1xuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgICAgICB0aGlzLl9saWtlQ291bnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1jb3VudFwiKTtcbiAgICAgICAgdGhpcy5fbGlrZUNvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuXG4gICAgICAgIHRoaXMuaXNMaWtlZCgpICYmIHRoaXMubGlrZUNhcmQodGhpcy5fbGlrZXMpO1xuXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gICAgfVxufSIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLmNsb3NlID0gdGhpcy5jbG9zZS5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9vdmVybGF5Q2xvc2UpO1xuXG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fb3ZlcmxheUNsb3NlKTtcblxuICAgIH1cbiAgICBfb3ZlcmxheUNsb3NlID0gKGV2dCkgPT4ge1xuICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSkge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idXR0b25cIilcbiAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG59IiwiaW1wb3J0IHtcbiAgICBQb3B1cFxufSBmcm9tIFwiLi9Qb3B1cFwiO1xuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IoUG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xuICAgICAgICBzdXBlcihQb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IHN1Ym1pdEhhbmRsZXI7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybScpO1xuICAgICAgICB0aGlzLl9pbnB1dHMgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKV07O1xuICAgIH1cbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG5cbiAgICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fVxuICAgICAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBpbnB1dFZhbHVlcztcblxuICAgIH1cbiAgICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5faW5wdXRzKVxuICAgIH1cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcih0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuICAgIGNsb3NlID0gKCkgPT4ge1xuICAgICAgICBzdXBlci5jbG9zZSgpXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7IC8vcmVzZXQgdGhlIGZvcm0gd2hlbiBvcGVubmluZyBhZ2FpblxuXG4gICAgfVxufSIsIi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vIFNlbGVjdG9ycyAvLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLWVkaXQtcHJvZmlsZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgaW5wdXROYW1lID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0W25hbWU9J25hbWUnXVwiKTtcbmV4cG9ydCBjb25zdCBpbnB1dFRpdGxlID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0W25hbWU9J3RpdGxlJ11cIik7XG5leHBvcnQgY29uc3QgY2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzXCIpO1xuXG5cbmV4cG9ydCBjb25zdCBjYXJkTGlzdCA9IGNhcmRzLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5leHBvcnQgY29uc3QgcGxhY2VQb3B1cEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtLXR5cGUtYWRkLXBsYWNlXCIpO1xuZXhwb3J0IGNvbnN0IG5hbWUgPSBwbGFjZVBvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0LXR5cGUtcGxhY2UtbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwbGFjZVVSTCA9IHBsYWNlUG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtdHlwZS1wbGFjZS11cmxcIik7XG5leHBvcnQgY29uc3QgaW1nUHJldmlldyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtcHJldlwiKTtcbmV4cG9ydCBjb25zdCBwb3B1cFByZXZpZXdJbWcgPSBpbWdQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwUHJldmlld0NhcHRpb24gPSBpbWdQcmV2aWV3LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2NhcHRpb25cIik7XG5cblxuZXhwb3J0IGNvbnN0IHBsYWNlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtcGxhY2VcIik7XG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XG5cblxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRQb3B1cCA9IHByb2ZpbGUucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9fY2xvc2UtYnV0dG9uJyk7XG5leHBvcnQgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1jb250YWluZXJcIik7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fdHlwZV9hdmF0YXJcIilcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFt7XG4gICAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICAgIH0sXG5dOyIsImNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycykgPT4ge1xuICAgIHJldHVybiBmZXRjaCh1cmwsIGhlYWRlcnMpXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKS5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coKSlcblxufVxuY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3Rvcih7XG4gICAgICAgIGJhc2VVcmwsXG4gICAgICAgIGhlYWRlcnNcbiAgICB9KSB7XG4gICAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgICB9XG5cblxuXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICAgIH0pXG4gICAgfVxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHNldFVzZXJJbmZvKHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXRcbiAgICB9KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0ZXN0Jywge1xuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIGFib3V0XG4gICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgYWJvdXQ6IGFib3V0LFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH0pXG4gICAgfVxuICAgIGNyZWF0ZUNhcmQoZGF0YSkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxuICAgICAgICB9KVxuXG4gICAgfVxuICAgIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgfSlcbiAgICB9XG4gICAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGNhcmRJZClcbiAgICAgICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHNldFVzZXJBdmF0YXIodXJsKSB7XG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgYXZhdGFyOiB1cmwsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfSlcbiAgICB9XG5cblxuICAgIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXG59XG5cbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIiwgLy9jb2hvcnQtMy1lblxuICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlZGRlM2E1Yy1iMzBkLTQwYjAtOTllOS02ZjcyZWU5NzZkZGZcIixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICB9XG59KTsiLCIvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBJTVBPUlRTIC8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5pbXBvcnQge1xuICBGb3JtVmFsaWRhdG9yXG59XG5mcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmltcG9ydCB7XG4gIENhcmRcbn0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHtcbiAgUG9wdXBcbn1cbmZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQge1xuICBQb3B1cFdpdGhGb3JtXG59XG5mcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQge1xuICBQb3B1cFdpdGhTdWJtaXRcbn1cbmZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdFwiO1xuaW1wb3J0IHtcbiAgU2VjdGlvblxufSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5cbmltcG9ydCB7XG4gIFVzZXJJbmZvXG59IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5cblxuaW1wb3J0IFwiLi4vc3R5bGVzL2luZGV4LmNzc1wiO1xuaW1wb3J0IHtcbiAgUG9wdXBXaXRoSW1hZ2Vcbn0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcblxuaW1wb3J0IHtcbiAgcHJvZmlsZUZvcm0sXG4gIHByb2ZpbGUsXG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlUG9wdXAsXG4gIHByb2ZpbGVUaXRsZSxcbiAgaW5wdXROYW1lLFxuICBpbnB1dFRpdGxlLFxuICBjYXJkcyxcbiAgY2FyZFRlbXBsYXRlLFxuICBjYXJkTGlzdCxcbiAgcHJvZmlsZUVkaXQsXG4gIHBsYWNlUG9wdXBGb3JtLFxuICBuYW1lLFxuICBwbGFjZVVSTCxcbiAgaW1nUHJldmlldyxcbiAgcG9wdXBQcmV2aWV3SW1nLFxuICBwb3B1cFByZXZpZXdDYXB0aW9uLFxuICBwbGFjZUZvcm0sXG4gIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxuICBlZGl0UHJvZmlsZUJ1dHRvbixcbiAgYWRkQ2FyZFBvcHVwLFxuICBjbG9zZUJ1dHRvbnMsXG4gIGluaXRpYWxDYXJkcyxcbiAgYXZhdGFyLFxuICBhdmF0YXJGb3JtLFxuXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHNcIlxuaW1wb3J0IHtcbiAgYXBpXG59IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiXG5cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vIEFQSSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIGNvbnNvbGUubG9nKGFwaSlcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG5jb25zdCBwbGFjZXNTZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICB9LFxuICBcIi5jYXJkc19fbGlzdFwiXG4pO1xuXG5cbmxldCB1c2VySWQ7XG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pXG4gIC50aGVuKChbY2FyZHMsIHVzZXJEYXRhXSkgPT4ge1xuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcbiAgICBwbGFjZXNTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS50aXRsZSk7XG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICB9KVxuICAudGhlbigoKSA9PiB1c2VySW5mby5zZXRBdmF0YXJWaXNpYmxlKCkpXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcblxuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLnBvcHVwLXByZXZcIik7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwLWVkaXQtcHJvZmlsZVwiLCAoZGF0YSkgPT4ge1xuICBjb25zb2xlLmxvZygnZGF0YSA9PicsIGRhdGEpXG4gIGFwaVxuICAgIC5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICBhYm91dDogZGF0YS50aXRsZVxuICAgIH0pXG5cbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lOiByZXMubmFtZSxcbiAgICAgICAgYWJvdXQ6IHJlcy5hYm91dFxuICAgICAgfSlcblxuICAgICAgZWRpdFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbn0pO1xuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cblxuXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBGb3JtIFZhbGlkdGF0aW9uIC8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5jb25zdCB2YWxpZGF0ZUNvbmZpZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JcIixcbn07XG5cbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRlQ29uZmlncyxcbiAgcHJvZmlsZVBvcHVwXG4pO1xucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGVDb25maWdzLCBwbGFjZUZvcm0pO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGVDb25maWdzLFxuICBhdmF0YXJGb3JtXG4pO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8gUG9wdXAgY3JlYXRpb24gLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXG5cblxuXG5cblxuXG5jb25zdCBwb3B1cEFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cC1wbGFjZVwiLCAoZGF0YSkgPT4ge1xuICBhcGlcbiAgICAuY3JlYXRlQ2FyZChkYXRhKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcbiAgICAgIHBvcHVwQWRkQ2FyZC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG59KTtcbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5wb3B1cC10eXBlLWRlbGV0ZS1jYXJkXCIpO1xuY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cF90eXBlX2F2YXRhclwiLCAoZGF0YSkgPT4ge1xuICAvLyBhdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUsIFwiU2F2aW5nIGF2YXRhci4uLlwiKTtcbiAgYXBpXG4gICAgLnNldFVzZXJBdmF0YXIoZGF0YS5saW5rKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7XG4gICAgICBhdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG4gIC8vIC5maW5hbGx5KCgpID0+IGF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcbn0pO1xuXG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmRlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBjYXJkIGNyZWF0aW9uIC8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuZnVuY3Rpb24gZ2VuZXJhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGRhdGEsXG4gICAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsIHtcbiAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YS5saW5rLCBkYXRhLm5hbWUpO1xuXG4gICAgICB9LFxuICAgICAgaGFuZGxlQ2FyZERlbGV0ZTogKGlkKSA9PiB7XG4gICAgICAgIGRlbGV0ZVBvcHVwLm9wZW4oKTtcblxuICAgICAgICBkZWxldGVQb3B1cC5zZXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICAgIC8vIHN1Ym1pdCBtb2RhbFxuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmRlbGV0ZUNhcmQoaWQpXG4gICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgZGVsZXRlUG9wdXAuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZUxpa2VDYXJkOiAoaWQpID0+IHtcbiAgICAgICAgY29uc3QgTGlrZWQgPSBjYXJkLmlzTGlrZWQoKTtcbiAgICAgICAgLy9saWtlIGNhcmRcbiAgICAgICAgaWYgKCFMaWtlZCkge1xuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmxpa2VDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICBjYXJkLmxpa2VDYXJkKHJlcy5saWtlcyk7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXMnLCByZXMpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuXG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvL2Rpc2xpa2UgY2FyZFxuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmRpc2xpa2VDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICBjYXJkLmRpc2xpa2VDYXJkKHJlcy5saWtlcyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0sXG4gICAgdXNlcklkXG4gICk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xuXG59XG5cblxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEpIHtcbiAgY29uc3QgZWxlbWVudCA9IGdlbmVyYXRlQ2FyZChkYXRhKTtcbiAgcGxhY2VzU2VjdGlvbi5hZGRJdGVtKGVsZW1lbnQpO1xufVxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8gRXZlbnRMaXN0ZW5lcnMgLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IGluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBlZGl0UG9wdXAuc2V0SW5wdXRWYWx1ZXMoaW5mbyk7XG4gIHByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgcHJvZmlsZUZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uKCk7XG4gIGVkaXRQb3B1cC5vcGVuKCk7XG5cbn0pO1xuXG5hZGRDYXJkUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcG9wdXBBZGRDYXJkLm9wZW4oKTtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcblxufSk7XG5hdmF0YXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgLy8gYXZhdGFyRm9ybVZhbGlkYXRvci5yZXNldEZvcm1CdXR0b24oKTtcbiAgYXZhdGFyUG9wdXAub3BlbigpO1xufSk7IiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3Rvcih7XG4gICAgICAgIG5hbWVTZWxlY3RvcixcbiAgICAgICAgam9iU2VsZWN0b3IsXG4gICAgICAgIGF2YXRhclNlbGVjdG9yXG4gICAgfSkge1xuICAgICAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcblxuICAgIH1cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxuICAgICAgICAgICAgYWJvdXQ6IHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQsXG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dFxuICAgIH0pIHtcbiAgICAgICAgdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50ID0gYWJvdXQ7XG4gICAgfVxuICAgIHNldFVzZXJBdmF0YXIoYXZhdGFyKSB7IC8vIGhlcmUgYWRkcyB0aGUgYXZhdGFyIHRvIERPTSBhZnRlciBmZXRjaGluZyBmcm9tIHNlcnZlclxuICAgICAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xuICAgIH1cblxuICAgIHNldEF2YXRhclZpc2libGUoKSB7XG4gICAgICAgIHRoaXMuX2F2YXRhci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XG4gICAgfVxufSIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih7XG4gICAgICAgIHJlbmRlcmVyXG4gICAgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICAgICAgLy8gdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICB9XG4gICAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhZGRJdGVtKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gICAgfVxufSIsImltcG9ydCB7XG4gICAgUG9wdXBcbn0gZnJvbSBcIi4vUG9wdXBcIjtcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuICAgICAgICB0aGlzLl9wb3B1cENhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2FwdGlvblwiKTtcblxuICAgIH1cbiAgICBvcGVuKGltYWdlLCB0ZXh0KSB7XG5cbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBpbWFnZTtcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBgQSB2aWV3IG9mICR7dGV4dH1gO1xuICAgICAgICB0aGlzLl9wb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxufSIsImltcG9ydCB7XG4gICAgUG9wdXBcbn0gZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcbiAgICBzZXRBY3Rpb24oYWN0aW9uKSB7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBhY3Rpb247XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIH1cbn0iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiY29uZmlncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXQiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2xhc3NMaXN0IiwiYWRkIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzVmFsaWRJbnB1dHMiLCJfaW5wdXRMaXN0IiwiZXZlcnkiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2J1dHRvbiIsInRvZ2dsZUJ1dHRvbiIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwicmVzZXRWYWxpZGF0aW9uIiwiZGlzYWJsZWQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsImRhdGEiLCJzZWxlY3RvciIsInVzZXJJZCIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUNhcmREZWxldGUiLCJoYW5kbGVMaWtlQ2FyZCIsImRvY3VtZW50IiwiX3NlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9saWtlQnV0dG9uIiwiX2hhbmRsZUxpa2VDYXJkIiwiX2lkIiwiX2ltYWdlIiwiX2hhbmRsZUNhcmRDbGljayIsIl9kZWxldGVCdXR0b24iLCJfaGFuZGxlQ2FyZERlbGV0ZSIsIl90ZXh0IiwibmFtZSIsIl9saW5rIiwibGluayIsIl91c2VySWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX2xpa2VzIiwibGlrZXMiLCJsaWtlQ2FyZCIsIm5ld0xpa2VzIiwiX2xpa2VDb3VudCIsImxlbmd0aCIsImRpc2xpa2VDYXJkIiwiaXNMaWtlZCIsInNvbWUiLCJsaWtlIiwicmVtb3ZlQ2FyZCIsIl9lbGVtZW50IiwiZ2VuZXJhdGVDYXJkIiwiX2dldENsb25lRnJvbVRlbXBsYXRlIiwic3JjIiwiYWx0Iiwic3R5bGUiLCJkaXNwbGF5IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJjb250YWlucyIsIl9wb3B1cEVsZW1lbnQiLCJiaW5kIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsIl9vdmVybGF5Q2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiUG9wdXBTZWxlY3RvciIsInN1Ym1pdEhhbmRsZXIiLCJzdXBlciIsIl9mb3JtRWxlbWVudCIsInJlc2V0IiwiX3N1Ym1pdEhhbmRsZXIiLCJfaW5wdXRzIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiY29uc29sZSIsImxvZyIsInByb2ZpbGUiLCJwcm9maWxlUG9wdXAiLCJwbGFjZVBvcHVwRm9ybSIsImZvcm0iLCJpbWdQcmV2aWV3IiwicGxhY2VGb3JtIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJhZGRDYXJkUG9wdXAiLCJhdmF0YXIiLCJhdmF0YXJGb3JtIiwiY3VzdG9tRmV0Y2giLCJ1cmwiLCJoZWFkZXJzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJjYXRjaCIsImVyciIsImFwaSIsImJhc2VVcmwiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjcmVhdGVDYXJkIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsInNldFVzZXJBdmF0YXIiLCJhdXRob3JpemF0aW9uIiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVKb2IiLCJfYXZhdGFyIiwic2V0QXZhdGFyVmlzaWJsZSIsInZpc2liaWxpdHkiLCJwbGFjZXNTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwicmVuZGVyQ2FyZCIsImFsbCIsImNhcmRzIiwidXNlckRhdGEiLCJ0aXRsZSIsImltYWdlUG9wdXAiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cENhcHRpb24iLCJpbWFnZSIsInRleHQiLCJlZGl0UG9wdXAiLCJ2YWxpZGF0ZUNvbmZpZ3MiLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJwb3B1cEFkZENhcmQiLCJkZWxldGVQb3B1cCIsInNldEFjdGlvbiIsImFjdGlvbiIsImF2YXRhclBvcHVwIiwiZWxlbWVudCIsImNhcmQiLCJpbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==