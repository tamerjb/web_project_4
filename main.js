!function(){"use strict";class e{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasValidInputs(){return this._inputList.every((e=>e.validity.valid))}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._button=this._form.querySelector(this._submitButtonSelector),this.toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButton()})),this.resetValidation()}))}toggleButton(){this._hasValidInputs()?(this._button.disabled=!1,this._button.classList.remove(this._inactiveButtonClass)):(this._button.disabled=!0,this._button.classList.add(this._inactiveButtonClass))}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}resetValidation(){this.toggleButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s,i,r){let{handleCardClick:n,handleCardDelete:o,handleLikeCard:a}=i;t(this,"_getCloneFromTemplate",(()=>document.querySelector(this._selector).content.querySelector(".card").cloneNode(!0))),t(this,"_setEventListeners",(()=>{this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this._id)})),this._image.addEventListener("click",(()=>{this._handleCardClick(this._id)})),this._deleteButton.addEventListener("click",(()=>{this._handleCardDelete(this._id)}))})),this._text=e.name,this._link=e.link,this._selector=s,this._handleCardClick=n,this._handleCardDelete=o,this._handleLikeCard=a,this._id=e._id,this._userId=r,this._ownerId=e.owner._id,this._likes=e.likes}likeCard(e){this._likeButton.classList.add("card__like-button_active"),this._likes=e,this._likeCount.textContent=this._likes.length}dislikeCard(e){this._likeButton.classList.remove("card__like-button_active"),this._likes=e,this._likeCount.textContent=this._likes.length}isLiked(){return this._likes.some((e=>e._id===this._userId))}removeCard(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getCloneFromTemplate(),this._image=this._element.querySelector(".card__image"),this._element.querySelector(".card__info-title").textContent=this._text,this._image.src=this._link,this._image.alt="Place in ".concat(this._text),this._deleteButton=this._element.querySelector(".card__image-trash"),this._ownerId!==this._userId&&(this._deleteButton.style.display="none"),this._likeButton=this._element.querySelector(".card__like-button"),this._likeCount=this._element.querySelector(".card__like-count"),this._likeCount.textContent=this._likes.length,this.isLiked()&&this.likeCard(this._likes),this._setEventListeners(),this._element}}function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e){i(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),i(this,"_overlayClose",(e=>{e.target.classList.contains("popup")&&this.close()})),this._popupElement=document.querySelector(e),this.close=this.close.bind(this)}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._overlayClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("click",this._overlayClose)}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("click",(()=>{this.close()}))}}class n extends r{constructor(e,t){var s,i;super(e),i=()=>{super.close(),this._formElement.reset()},(s="close")in this?Object.defineProperty(this,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[s]=i,this._submitHandler=t,this._formElement=this._popupElement.querySelector(".popup__form"),this._inputs=[...this._formElement.querySelectorAll(".form__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]})),console.log(this._inputs)}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues()),this.close()})),super.setEventListeners()}}const o=document.querySelector(".profile"),a=document.querySelector(".popup-edit-profile"),l=document.querySelector(".popup-place"),c=o.querySelector(".profile__edit-button"),h=o.querySelector(".profile__add-button"),d=document.querySelector(".profile__image-container"),u=document.querySelector(".popup__form_type_avatar"),_=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch((e=>console.log())),p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return _("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return _("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}setUserInfo(e){let{name:t,about:s}=e;return _("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})})}createCard(e){return _("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return _("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}likeCard(e){return _("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}dislikeCard(e){return _("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}setUserAvatar(e){return _("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"edde3a5c-b30d-40b0-99e9-6f72ee976ddf","Content-Type":"application/json"}}),m=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._profileName.textContent,about:this._profileJob.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._profileName.textContent=t,this._profileJob.textContent=s}setUserAvatar(e){this._avatar.src=e}setAvatarVisible(){this._avatar.style.visibility="visible"}}({nameSelector:".profile__name",jobSelector:".profile__title",avatarSelector:".profile__image"}),v=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:q},".cards__list");let b;Promise.all([p.getInitialCards(),p.getUserInfo()]).then((e=>{let[t,s]=e;b=s._id,v.renderItems(t),m.setUserInfo(s.name,s.about),m.setUserAvatar(s.avatar)})).then((()=>m.setAvatarVisible())).catch((e=>console.log(e)));const C={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input-error",errorClass:"form__input-error"},f=new e(C,a);f.enableValidation();const E=new e(C,l);E.enableValidation();const k=new e(C,u);k.enableValidation();const y=new n(".popup",(e=>{p.setUserInfo({name:e.name,about:e.about}).then((e=>{m.getUserInfo(),m.setUserInfo({name:e.name,about:e.about}),y.close()})).catch((e=>console.log(e)))}));y.setEventListeners();const g=new n(".popup-place",(e=>{p.createCard(e).then((e=>{q(e),g.close()})).catch((e=>console.log(e)))}));g.setEventListeners();const L=new n(".popup_type_avatar",(e=>{p.setUserAvatar(e.link).then((e=>{m.setUserAvatar(e.avatar),L.close()})).catch((e=>console.log(e)))}));L.setEventListeners();const S=new class extends r{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".popup__image"),this._popupCaption=this._popupElement.querySelector(".popup__caption")}open(e,t){this._popupImage.src=e,this._popupImage.alt="A view of ".concat(t),this._popupCaption.textContent=t,super.open()}}(".popup-prev");S.setEventListeners();const I=new class extends r{setAction(e){this._submitHandler=e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}}(".popup-type-delete-card");function q(e){const t=function(e){const t=new s(e,"#card-template",{handleCardClick:()=>{S.open(e.link,e.name)},handleCardDelete:e=>{I.open(),I.setAction((()=>{p.deleteCard(e).then((e=>{t.removeCard()})).then((()=>{I.close()})).catch((e=>console.log(e)))}))},handleLikeCard:e=>{t.isLiked()?p.dislikeCard(e).then((e=>{t.dislikeCard(e.likes)})).catch((e=>console.log(e))):p.likeCard(e).then((e=>{t.likeCard(e.likes)})).catch((e=>console.log(e)))}},b);return t.generateCard()}(e);v.addItem(t)}I.setEventListeners(),c.addEventListener("click",(()=>{const e=m.getUserInfo();y.setInputValues(e),f.enableValidation(),f.toggleButton(),y.open()})),h.addEventListener("click",(()=>{g.open(),E.resetValidation()})),d.addEventListener("click",(()=>{k.resetValidation(),L.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGlCQUFpQixTQUFTLEtBQ3JDOEksRUFBYXBGLE9BQ2JpRixFQUFpQjFJLHFCQUduQmlGLEVBQU9sRixpQkFBaUIsU0FBUyxLQUMvQjRJLEVBQW9CM0ksa0JBQ3BCOEksRUFBWXJGLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gICAgY29uc3RydWN0b3IoY29uZmlncywgZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlncy5pbnB1dFNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgICAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlncy5lcnJvckNsYXNzO1xuXG4gICAgfVxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dCkge1xuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgICAgICAvLyBhZGQgZXJyb3IgbXNnL2NsYXNzXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgICAgICAvLyBpbnB1dC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpXG4gICAgfVxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dCkge1xuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0LmlkfS1lcnJvcmApO1xuICAgICAgICAvLyBhZGQgZXJyb3IgbXNnL2NsYXNzXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIC8vIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoZXJyb3JDbGFzcyk7XG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgICAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG5cbiAgICB9XG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkge1xuICAgICAgICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuICAgIF9oYXNWYWxpZElucHV0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgICAgICAgfSlcblxuICAgIH1cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b24oKTtcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5yZXNldFZhbGlkYXRpb24oKTtcblxuICAgICAgICB9KTtcbiAgICB9XG4gICAgdG9nZ2xlQnV0dG9uKCkge1xuICAgICAgICBpZiAodGhpcy5faGFzVmFsaWRJbnB1dHMoKSkge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9idXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9idXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgfVxuXG4gICAgfVxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4gZS5wcmV2ZW50RGVmYXVsdCgpKTtcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKCk7IC8vIDw9ID0gY29udHJvbGxpbmcgdGhlIHN1Ym1pdCBidXR0b24gPT1cblxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KSAvLzw9ID0gY2xlYXJpbmcgZXJyb3JzID09XG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG59IiwiZXhwb3J0IGNsYXNzIENhcmQge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBkYXRhLFxuICAgICAgICBzZWxlY3Rvciwge1xuICAgICAgICAgICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgICAgICAgICAgaGFuZGxlQ2FyZERlbGV0ZSxcbiAgICAgICAgICAgIGhhbmRsZUxpa2VDYXJkLFxuICAgICAgICB9LCB1c2VySWRcbiAgICApIHtcbiAgICAgICAgdGhpcy5fdGV4dCA9IGRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICAgICAgdGhpcy5fc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlID0gaGFuZGxlQ2FyZERlbGV0ZTtcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcbiAgICAgICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICAgICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgICAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB9XG4gICAgX2dldENsb25lRnJvbVRlbXBsYXRlID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcilcbiAgICAgICAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICAgIH1cblxuICAgIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcblxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCh0aGlzLl9pZCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9pbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX2lkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZSh0aGlzLl9pZCk7XG5cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBsaWtlQ2FyZChuZXdMaWtlcykge1xuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XG4gICAgICAgIHRoaXMuX2xpa2VDb3VudC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB9XG5cbiAgICBkaXNsaWtlQ2FyZChuZXdMaWtlcykge1xuICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XG4gICAgICAgIHRoaXMuX2xpa2VDb3VudC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB9XG4gICAgaXNMaWtlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpO1xuICAgIH1cblxuICAgIHJlbW92ZUNhcmQoKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuXG4gICAgfVxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldENsb25lRnJvbVRlbXBsYXRlKCk7XG4gICAgICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuXG5cbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2luZm8tdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgICAgICB0aGlzLl9pbWFnZS5hbHQgPSBgUGxhY2UgaW4gJHt0aGlzLl90ZXh0fWA7XG5cbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlLXRyYXNoXCIpO1xuXG5cbiAgICAgICAgdGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkICYmXG4gICAgICAgICAgICAodGhpcy5fZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIik7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgICAgIHRoaXMuX2xpa2VDb3VudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50XCIpO1xuICAgICAgICB0aGlzLl9saWtlQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG5cbiAgICAgICAgdGhpcy5pc0xpa2VkKCkgJiYgdGhpcy5saWtlQ2FyZCh0aGlzLl9saWtlcyk7XG5cbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgICB9XG59IiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuY2xvc2UgPSB0aGlzLmNsb3NlLmJpbmQodGhpcyk7XG4gICAgfVxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX292ZXJsYXlDbG9zZSk7XG5cbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9vdmVybGF5Q2xvc2UpO1xuXG4gICAgfVxuICAgIF9vdmVybGF5Q2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ1dHRvblwiKVxuICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn0iLCJpbXBvcnQge1xuICAgIFBvcHVwXG59IGZyb20gXCIuL1BvcHVwXCI7XG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3RvcihQb3B1cFNlbGVjdG9yLCBzdWJtaXRIYW5kbGVyKSB7XG4gICAgICAgIHN1cGVyKFBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyID0gc3VibWl0SGFuZGxlcjtcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG4gICAgICAgIHRoaXMuX2lucHV0cyA9IFsuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpXTs7XG4gICAgfVxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcblxuICAgICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9XG4gICAgICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuXG4gICAgfVxuICAgIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLl9pbnB1dHMpXG4gICAgfVxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG4gICAgY2xvc2UgPSAoKSA9PiB7XG4gICAgICAgIHN1cGVyLmNsb3NlKClcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTsgLy9yZXNldCB0aGUgZm9ybSB3aGVuIG9wZW5uaW5nIGFnYWluXG5cbiAgICB9XG59IiwiLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8gU2VsZWN0b3JzIC8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBleHBvcnQgY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XG4vLyBleHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbi8vIGV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG4vLyBleHBvcnQgY29uc3QgaW5wdXROYW1lID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0W25hbWU9J25hbWUnXVwiKTtcbi8vIGV4cG9ydCBjb25zdCBpbnB1dFRpdGxlID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0W25hbWU9J3RpdGxlJ11cIik7XG4vLyBleHBvcnQgY29uc3QgY2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzXCIpO1xuLy8gZXhwb3J0IGNvbnN0IGNhcmRMaXN0ID0gY2FyZHMucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbi8vIGV4cG9ydCBjb25zdCBwbGFjZVBvcHVwRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0tdHlwZS1hZGQtcGxhY2VcIik7XG4vLyBleHBvcnQgY29uc3QgbmFtZSA9IHBsYWNlUG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtdHlwZS1wbGFjZS1uYW1lXCIpO1xuLy8gZXhwb3J0IGNvbnN0IHBsYWNlVVJMID0gcGxhY2VQb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dC10eXBlLXBsYWNlLXVybFwiKTtcbi8vIGV4cG9ydCBjb25zdCBpbWdQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1wcmV2XCIpO1xuLy8gZXhwb3J0IGNvbnN0IHBvcHVwUHJldmlld0ltZyA9IGltZ1ByZXZpZXcucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XG4vLyBleHBvcnQgY29uc3QgcG9wdXBQcmV2aWV3Q2FwdGlvbiA9IGltZ1ByZXZpZXcucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2FwdGlvblwiKTtcbi8vIGV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2Nsb3NlLWJ1dHRvbicpO1xuXG5cbmV4cG9ydCBjb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtZWRpdC1wcm9maWxlXCIpO1xuZXhwb3J0IGNvbnN0IHBsYWNlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtcGxhY2VcIik7XG5leHBvcnQgY29uc3QgY2FyZFRlbXBsYXRlU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZFBvcHVwID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1jb250YWluZXJcIik7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fdHlwZV9hdmF0YXJcIilcblxuLy8gZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFt7XG4vLyAgICAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4vLyAgICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4vLyAgICAgfSxcbi8vICAgICB7XG4vLyAgICAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbi8vICAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbi8vICAgICB9LFxuLy8gICAgIHtcbi8vICAgICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuLy8gICAgIH0sXG4vLyAgICAge1xuLy8gICAgICAgICBuYW1lOiBcIkxhdGVtYXJcIixcbi8vICAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuLy8gICAgIH0sXG4vLyAgICAge1xuLy8gICAgICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuLy8gICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4vLyAgICAgfSxcbi8vICAgICB7XG4vLyAgICAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbi8vICAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuLy8gICAgIH0sXG4vLyBdOyIsImNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycykgPT4ge1xuICAgIHJldHVybiBmZXRjaCh1cmwsIGhlYWRlcnMpXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKS5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coKSlcblxufVxuY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3Rvcih7XG4gICAgICAgIGJhc2VVcmwsXG4gICAgICAgIGhlYWRlcnNcbiAgICB9KSB7XG4gICAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgICB9XG5cblxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICAgICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICAgICB9KVxuICAgIH1cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xuICAgICAgICB9KVxuICAgIH1cbiAgICBzZXRVc2VySW5mbyh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0XG4gICAgfSkge1xuXG4gICAgICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICAgIGFib3V0OiBhYm91dCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICB9KVxuICAgIH1cbiAgICBjcmVhdGVDYXJkKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcbiAgICAgICAgfSlcblxuICAgIH1cbiAgICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICAgIH0pXG4gICAgfVxuICAgIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgICAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZGlzbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgfSlcbiAgICB9XG4gICAgc2V0VXNlckF2YXRhcih1cmwpIHtcbiAgICAgICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBhdmF0YXI6IHVybCxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICB9KVxuICAgIH1cblxuXG4gICAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcbn1cblxuZXhwb3J0IGNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICAgIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLCAvL2NvaG9ydC0zLWVuXG4gICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBcImVkZGUzYTVjLWIzMGQtNDBiMC05OWU5LTZmNzJlZTk3NmRkZlwiLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgIH1cbn0pOyIsIi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vIElNUE9SVFMgLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmltcG9ydCB7XG4gIEZvcm1WYWxpZGF0b3Jcbn1cbmZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcblxuaW1wb3J0IHtcbiAgQ2FyZFxufSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQge1xuICBQb3B1cFxufVxuZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcbmltcG9ydCB7XG4gIFBvcHVwV2l0aEZvcm1cbn1cbmZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCB7XG4gIFBvcHVwV2l0aFN1Ym1pdFxufVxuZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0XCI7XG5pbXBvcnQge1xuICBTZWN0aW9uXG59IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcblxuaW1wb3J0IHtcbiAgVXNlckluZm9cbn0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcblxuXG5pbXBvcnQgXCIuLi9zdHlsZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQge1xuICBQb3B1cFdpdGhJbWFnZVxufSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuXG5pbXBvcnQge1xuICBwcm9maWxlUG9wdXAsXG4gIHByb2ZpbGUsXG4gIHBsYWNlRm9ybSxcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXG4gIGVkaXRQcm9maWxlQnV0dG9uLFxuICBhZGRDYXJkUG9wdXAsXG4gIGF2YXRhcixcbiAgYXZhdGFyRm9ybSxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50c1wiXG5pbXBvcnQge1xuICBhcGlcbn0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpXCJcblxuLy8gcHJvZmlsZVRpdGxlLFxuLy8gaW5wdXROYW1lLFxuLy8gaW5wdXRUaXRsZSxcbi8vIGNhcmRzLFxuLy8gY2FyZFRlbXBsYXRlLFxuLy8gY2FyZExpc3QsXG4vLyBwcm9maWxlRWRpdCxcbi8vIHBsYWNlUG9wdXBGb3JtLFxuLy8gbmFtZSxcbi8vIHBsYWNlVVJMLFxuLy8gaW1nUHJldmlldyxcbi8vIHBvcHVwUHJldmlld0ltZyxcbi8vIHBvcHVwUHJldmlld0NhcHRpb24sXG4vLyAgIGNsb3NlQnV0dG9ucyxcbi8vICAgaW5pdGlhbENhcmRzLFxuLy8gICAgIHByb2ZpbGVGb3JtLFxuLy9cbi8vICAgICBwcm9maWxlTmFtZSxcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vIEFQSSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG5jb25zdCBwbGFjZXNTZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICB9LFxuICBcIi5jYXJkc19fbGlzdFwiXG4pO1xuXG5cbmxldCB1c2VySWQ7XG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pXG4gIC50aGVuKChbY2FyZHMsIHVzZXJEYXRhXSkgPT4ge1xuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcbiAgICBwbGFjZXNTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICB9KVxuICAudGhlbigoKSA9PiB1c2VySW5mby5zZXRBdmF0YXJWaXNpYmxlKCkpXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBGb3JtIFZhbGlkdGF0aW9uIC8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5jb25zdCB2YWxpZGF0ZUNvbmZpZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JcIixcbn07XG5cbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRlQ29uZmlncyxcbiAgcHJvZmlsZVBvcHVwXG4pO1xucHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGVDb25maWdzLCBwbGFjZUZvcm0pO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGVDb25maWdzLFxuICBhdmF0YXJGb3JtXG4pO1xuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBQb3B1cCBjcmVhdGlvbiAvLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwXCIsIChkYXRhKSA9PiB7XG4gIGFwaVxuICAgIC5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICBhYm91dDogZGF0YS5hYm91dFxuICAgIH0pXG5cbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lOiByZXMubmFtZSxcbiAgICAgICAgYWJvdXQ6IHJlcy5hYm91dFxuICAgICAgfSlcblxuICAgICAgZWRpdFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbn0pO1xuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cblxuY29uc3QgcG9wdXBBZGRDYXJkID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXAtcGxhY2VcIiwgKGRhdGEpID0+IHtcbiAgYXBpXG4gICAgLmNyZWF0ZUNhcmQoZGF0YSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKHJlcyk7XG4gICAgICBwb3B1cEFkZENhcmQuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxufSk7XG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3R5cGVfYXZhdGFyXCIsIChkYXRhKSA9PiB7XG4gIC8vIGF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJTYXZpbmcgYXZhdGFyLi4uXCIpO1xuICBhcGlcbiAgICAuc2V0VXNlckF2YXRhcihkYXRhLmxpbmspXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcbiAgICAgIGF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgLy8gLmZpbmFsbHkoKCkgPT4gYXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSkpO1xufSk7XG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5wb3B1cC1wcmV2XCIpO1xuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBjYXJkIGNyZWF0aW9uIC8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5wb3B1cC10eXBlLWRlbGV0ZS1jYXJkXCIpO1xuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gZ2VuZXJhdGVDYXJkKGRhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGRhdGEsXG4gICAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsIHtcbiAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuICAgICAgICBpbWFnZVBvcHVwLm9wZW4oZGF0YS5saW5rLCBkYXRhLm5hbWUpO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZUNhcmREZWxldGU6IChpZCkgPT4ge1xuICAgICAgICBkZWxldGVQb3B1cC5vcGVuKCk7XG5cbiAgICAgICAgZGVsZXRlUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgICAvLyBzdWJtaXQgbW9kYWxcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5kZWxldGVDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIGRlbGV0ZVBvcHVwLmNsb3NlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVMaWtlQ2FyZDogKGlkKSA9PiB7XG4gICAgICAgIGNvbnN0IExpa2VkID0gY2FyZC5pc0xpa2VkKCk7XG4gICAgICAgIC8vbGlrZSBjYXJkXG4gICAgICAgIGlmICghTGlrZWQpIHtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5saWtlQ2FyZChpZClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC5saWtlQ2FyZChyZXMubGlrZXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcblxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy9kaXNsaWtlIGNhcmRcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5kaXNsaWtlQ2FyZChpZClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC5kaXNsaWtlQ2FyZChyZXMubGlrZXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICAgIHVzZXJJZFxuICApO1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gIHJldHVybiBjYXJkRWxlbWVudDtcblxufVxuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEpIHtcbiAgY29uc3QgZWxlbWVudCA9IGdlbmVyYXRlQ2FyZChkYXRhKTtcbiAgcGxhY2VzU2VjdGlvbi5hZGRJdGVtKGVsZW1lbnQpO1xufVxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBFdmVudExpc3RlbmVycyAvLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGVkaXRQb3B1cC5zZXRJbnB1dFZhbHVlcyhpbmZvKTtcbiAgcHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICBwcm9maWxlRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b24oKTtcbiAgZWRpdFBvcHVwLm9wZW4oKTtcblxufSk7XG5cbmFkZENhcmRQb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwb3B1cEFkZENhcmQub3BlbigpO1xuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuXG59KTtcbmF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBhdmF0YXJQb3B1cC5vcGVuKCk7XG59KTsiLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKHtcbiAgICAgICAgbmFtZVNlbGVjdG9yLFxuICAgICAgICBqb2JTZWxlY3RvcixcbiAgICAgICAgYXZhdGFyU2VsZWN0b3JcbiAgICB9KSB7XG4gICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9wcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuXG4gICAgfVxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXG4gICAgICAgICAgICBhYm91dDogdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCxcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRVc2VySW5mbyh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0XG4gICAgfSkge1xuICAgICAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgICB9XG4gICAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHsgLy8gaGVyZSBhZGRzIHRoZSBhdmF0YXIgdG8gRE9NIGFmdGVyIGZldGNoaW5nIGZyb20gc2VydmVyXG4gICAgICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XG4gICAgfVxuXG4gICAgc2V0QXZhdGFyVmlzaWJsZSgpIHtcbiAgICAgICAgdGhpcy5fYXZhdGFyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcbiAgICB9XG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHtcbiAgICAgICAgcmVuZGVyZXJcbiAgICB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICAvLyB0aGlzLml0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIH1cbiAgICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgICAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFkZEl0ZW0oaXRlbSkge1xuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgICB9XG59IiwiaW1wb3J0IHtcbiAgICBQb3B1cFxufSBmcm9tIFwiLi9Qb3B1cFwiO1xuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XG4gICAgICAgIHRoaXMuX3BvcHVwQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xuXG4gICAgfVxuICAgIG9wZW4oaW1hZ2UsIHRleHQpIHtcblxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGltYWdlO1xuICAgICAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGBBIHZpZXcgb2YgJHt0ZXh0fWA7XG4gICAgICAgIHRoaXMuX3BvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICB9XG59IiwiaW1wb3J0IHtcbiAgICBQb3B1cFxufSBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xuICAgIHNldEFjdGlvbihhY3Rpb24pIHtcbiAgICAgICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IGFjdGlvbjtcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxufSJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2Zvcm0iLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dCIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNWYWxpZElucHV0cyIsIl9pbnB1dExpc3QiLCJldmVyeSIsIl9zZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfYnV0dG9uIiwidG9nZ2xlQnV0dG9uIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZXNldFZhbGlkYXRpb24iLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsInNlbGVjdG9yIiwidXNlcklkIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQ2FyZERlbGV0ZSIsImhhbmRsZUxpa2VDYXJkIiwiZG9jdW1lbnQiLCJfc2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2xpa2VCdXR0b24iLCJfaGFuZGxlTGlrZUNhcmQiLCJfaWQiLCJfaW1hZ2UiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVDYXJkRGVsZXRlIiwiX3RleHQiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX3VzZXJJZCIsIl9vd25lcklkIiwib3duZXIiLCJfbGlrZXMiLCJsaWtlcyIsImxpa2VDYXJkIiwibmV3TGlrZXMiLCJfbGlrZUNvdW50IiwibGVuZ3RoIiwiZGlzbGlrZUNhcmQiLCJpc0xpa2VkIiwic29tZSIsImxpa2UiLCJyZW1vdmVDYXJkIiwiX2VsZW1lbnQiLCJnZW5lcmF0ZUNhcmQiLCJfZ2V0Q2xvbmVGcm9tVGVtcGxhdGUiLCJzcmMiLCJhbHQiLCJzdHlsZSIsImRpc3BsYXkiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJldnQiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwRWxlbWVudCIsImJpbmQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX292ZXJsYXlDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJQb3B1cFNlbGVjdG9yIiwic3VibWl0SGFuZGxlciIsInN1cGVyIiwiX2Zvcm1FbGVtZW50IiwicmVzZXQiLCJfc3VibWl0SGFuZGxlciIsIl9pbnB1dHMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJjb25zb2xlIiwibG9nIiwicHJvZmlsZSIsInByb2ZpbGVQb3B1cCIsInBsYWNlRm9ybSIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkQ2FyZFBvcHVwIiwiYXZhdGFyIiwiYXZhdGFyRm9ybSIsImN1c3RvbUZldGNoIiwidXJsIiwiaGVhZGVycyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiY2F0Y2giLCJlcnIiLCJhcGkiLCJiYXNlVXJsIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY3JlYXRlQ2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJzZXRVc2VyQXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiX2F2YXRhciIsInNldEF2YXRhclZpc2libGUiLCJ2aXNpYmlsaXR5IiwicGxhY2VzU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsInJlbmRlckNhcmQiLCJhbGwiLCJjYXJkcyIsInVzZXJEYXRhIiwidmFsaWRhdGVDb25maWdzIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImVkaXRQb3B1cCIsInBvcHVwQWRkQ2FyZCIsImF2YXRhclBvcHVwIiwiaW1hZ2VQb3B1cCIsIl9wb3B1cEltYWdlIiwiX3BvcHVwQ2FwdGlvbiIsImltYWdlIiwidGV4dCIsImRlbGV0ZVBvcHVwIiwic2V0QWN0aW9uIiwiYWN0aW9uIiwiZWxlbWVudCIsImNhcmQiLCJpbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==