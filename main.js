!function(){"use strict";class e{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass)}_hideInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasValidInputs(){return this._inputList.every((e=>e.validity.valid))}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._button=this._form.querySelector(this._submitButtonSelector),this.toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButton()})),this.resetValidation()}))}toggleButton(){this._hasValidInputs()?(this._button.disabled=!1,this._button.classList.remove(this._inactiveButtonClass)):(this._button.disabled=!0,this._button.classList.add(this._inactiveButtonClass))}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}resetValidation(){this.toggleButton(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s,r,i){let{handleCardClick:o,handleCardDelete:n,handleLikeCard:l}=r;t(this,"_getCloneFromTemplate",(()=>document.querySelector(this._selector).content.querySelector(".card").cloneNode(!0))),t(this,"_setEventListeners",(()=>{this._likeButton.addEventListener("click",(e=>{this._handleLikeCard(e)})),this._image.addEventListener("click",(()=>{this._handleCardClick(this._id)})),this._deleteButton.addEventListener("click",(()=>{this._handleCardDelete(this._id)}))})),this._text=e.name,this._link=e.link,this._selector=s,this._handleCardClick=o,this._handleCardDelete=n,this._handleLikeCard=l,this._id=e.id,this._userId=i,this._ownerId=e.owner._id,this._likes=e.likes,console.log("data.name",e.name)}likeCard(e){this._likeButton.classList.add("card__like-button_active"),this._likes=e,this._likeCount.textContent=this._likes.length}dislikeCard(e){this._likeButton.classList.remove("card__like-button_active"),this._likes=e,this._likeCount.textContent=this._likes.length}isLiked(){return this._likes.some((e=>e._id===this._userId))}removeCard(){this._element.remove(),this._element=null}generateCard(){return this._element=this._getCloneFromTemplate(),this._image=this._element.querySelector(".card__image"),this._element.querySelector(".card__info-title").textContent=this._text,this._image.src=this._link,this._image.alt="Place in ".concat(this._text),this._deleteButton=this._element.querySelector(".card__image-trash"),this._ownerId!==this._userId&&(this._deleteButton.style.display="none"),this._likeButton=this._element.querySelector(".card__like-button"),this._likeCount=this._element.querySelector(".card__like-count"),this._likeCount.textContent=this._likes.length,this.isLiked()&&this.likeCard(this._likes),this._setEventListeners(),this._element}}class r{constructor(e){this._popupElement=document.querySelector(e),this.close=this.close.bind(this),this._handleEscClose=this._handleEscClose.bind(this),this._overlayClose=this._overlayClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._overlayClose)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("click",this._overlayClose)}_overlayClose(e){e.target.classList.contains("popup_opened")&&this.close()}setEventListeners(){this._popupElement.querySelector(".popup__close-button").addEventListener("click",this.close)}}class i extends r{constructor(e,t){var s,r;super(e),r=()=>{super.close(),this._formElement.reset()},(s="close")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this._submitHandler=t,this._formElement=this._popupElement.querySelector(".popup__form"),this._inputs=[...this._formElement.querySelectorAll(".form__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]})),console.log(this._inputs)}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues()),this.close()})),super.setEventListeners()}}document.querySelector(".form");const o=document.querySelector(".profile"),n=(o.querySelector(".profile__name"),document.querySelector(".popup")),l=(o.querySelector(".profile__title"),form.querySelector(".form__input[name='name']"),form.querySelector(".form__input[name='title']"),document.querySelector(".cards")),a=(document.querySelector("#card-template"),l.querySelector(".cards__list"),document.querySelector(".popup-edit-profile"),document.querySelector(".popup__form-type-add-place")),c=(a.querySelector(".form__input-type-place-name"),a.querySelector(".form__input-type-place-url"),document.querySelector(".popup-prev")),h=(c.querySelector(".popup__image"),c.querySelector(".popup__caption"),document.querySelector(".popup-place")),u=o.querySelector(".profile__edit-button"),d=o.querySelector(".profile__add-button"),_=(document.querySelectorAll(".popup__close-button"),(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch((e=>console.log()))),p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getInitialCards(){return _("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return _("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}setUserInfo(e){let{name:t,about:s}=e;return _("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})})}createCard(e){return _("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return _("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}likeCard(e){return console.log(e),_("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}dislikeCard(e){return _("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"edde3a5c-b30d-40b0-99e9-6f72ee976ddf","Content-Type":"application/json"}}),m=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:L},".cards__list");let C;Promise.all([p.getInitialCards(),p.getUserInfo()]).then((e=>{let[t,s]=e;C=s._id,m.renderItems(t),y.setUserInfo(s.name,s.about)})).catch((e=>console.log(e))),u.addEventListener("click",(()=>{const e=y.getUserInfo();k.setInputValues(e),f.enableValidation(),f.toggleButton(),k.open()})),d.addEventListener("click",(()=>{S.open(),b.resetValidation()}));const v={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input-error",errorClass:"form__input-error"},f=new e(v,n),b=new e(v,h);f.enableValidation(),b.enableValidation();const y=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._profileName.textContent,title:this._profileJob.textContent}}setUserInfo(e){let{name:t,job:s}=e;this._profileName.textContent=t,this._profileJob.textContent=s}setUserAvatar(e){this._avatar.src=e}setAvatarVisible(){this._avatar.style.visibility="visible"}}({nameSelector:".profile__name",jobSelector:".profile__title"}),E=new class extends r{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".popup__image"),this._popupCaption=this._popupElement.querySelector(".popup__caption")}open(e,t){this._popupImage.src=e,this._popupImage.alt="A view of ".concat(t),this._popupCaption.textContent=t,super.open()}}(".popup-prev");E.setEventListeners();const k=new i(".popup",(e=>{console.log("data =>",e),p.setUserInfo({name:e.name,about:e.title}).then((e=>{y.setUserInfo({name:e.name,about:e.title}),k.close()})).catch((e=>console.log(e)))}));k.setEventListeners();const S=new i(".popup-place",(e=>{p.createCard(e).then((e=>{L(e),S.close()})).catch((e=>console.log(e)))}));S.setEventListeners();const g=new class extends r{setAction(e){this._submitHandler=e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}}(".popup-type-delete-card");function L(e){const t=function(e){const t=new s(e,"#card-template",{handleCardClick:()=>{E.open(e.link,e.text)},handleCardDelete:e=>{g.open(),g.setAction((()=>{p.deleteCard(e).then((e=>{t.removeCard()})).then((()=>{g.close()})).catch((e=>console.log(e)))}))},handleLikeCard:e=>{t.isLiked()?p.dislikeCard(e).then((e=>{t.dislikeCard(e.likes)})).catch((e=>console.log(e))):p.likeCard(e).then((e=>{t.likeCard(e.likes),console.log("res",e)})).catch((e=>console.log(e)))}},C);return t.generateCard()}(e);m.addItem(t)}g.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUMsSUFBSStELE9BY3BDekYsR0FHRixPQURvQm1KLEVBQUs5RyxlQW9KVEEsQ0FBYXZDLEdBQzdCNEcsRUFBY1EsUUFBUWdDLEdBOUN4QkgsRUFBWXhGLG9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICAgIGNvbnN0cnVjdG9yKGNvbmZpZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWdzLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZ3MuZXJyb3JDbGFzcztcblxuICAgIH1cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICAgICAgLy8gYWRkIGVycm9yIG1zZy9jbGFzc1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICAgICAgLy8gaW5wdXQuY2xhc3NMaXN0LmFkZChlcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKVxuICAgIH1cbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICAgICAgLy8gYWRkIGVycm9yIG1zZy9jbGFzc1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICAvLyBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuXG4gICAgfVxuICAgIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpIHtcbiAgICAgICAgaWYgKCFpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuXG4gICAgICAgIH1cblxuICAgIH1cbiAgICBfaGFzVmFsaWRJbnB1dHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaW5wdXQudmFsaWRpdHkudmFsaWQ7XG4gICAgICAgIH0pXG5cbiAgICB9XG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKCk7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMucmVzZXRWYWxpZGF0aW9uKCk7XG5cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHRvZ2dsZUJ1dHRvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuX2hhc1ZhbGlkSW5wdXRzKCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIH1cblxuICAgIH1cbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IGUucHJldmVudERlZmF1bHQoKSk7XG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbigpOyAvLyA8PSA9IGNvbnRyb2xsaW5nIHRoZSBzdWJtaXQgYnV0dG9uID09XG5cbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCkgLy88PSA9IGNsZWFyaW5nIGVycm9ycyA9PVxuICAgICAgICB9KTtcblxuICAgIH1cblxufSIsImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgZGF0YSxcbiAgICAgICAgc2VsZWN0b3IsIHtcbiAgICAgICAgICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICAgICAgICAgIGhhbmRsZUNhcmREZWxldGUsXG4gICAgICAgICAgICBoYW5kbGVMaWtlQ2FyZFxuICAgICAgICB9LFxuICAgICAgICB1c2VySWRcbiAgICApIHtcbiAgICAgICAgdGhpcy5fdGV4dCA9IGRhdGEubmFtZTtcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICAgICAgdGhpcy5fc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlID0gaGFuZGxlQ2FyZERlbGV0ZTtcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcbiAgICAgICAgdGhpcy5faWQgPSBkYXRhLmlkO1xuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgICAgICBjb25zb2xlLmxvZygnZGF0YS5uYW1lJywgZGF0YS5uYW1lKVxuXG4gICAgfVxuICAgIF9nZXRDbG9uZUZyb21UZW1wbGF0ZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3IpXG4gICAgICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgICAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgICB9XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG5cbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQoZXZ0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2ltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5faWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlKHRoaXMuX2lkKTtcblxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGxpa2VDYXJkKG5ld0xpa2VzKSB7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcbiAgICAgICAgdGhpcy5fbGlrZUNvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuICAgIH1cblxuICAgIGRpc2xpa2VDYXJkKG5ld0xpa2VzKSB7XG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcbiAgICAgICAgdGhpcy5fbGlrZUNvdW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuICAgIH1cbiAgICBpc0xpa2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gICAgfVxuXG4gICAgcmVtb3ZlQ2FyZCgpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG5cbiAgICB9XG4gICAgZ2VuZXJhdGVDYXJkKCkge1xuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0Q2xvbmVGcm9tVGVtcGxhdGUoKTtcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG5cblxuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW5mby10aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XG4gICAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgICAgIHRoaXMuX2ltYWdlLmFsdCA9IGBQbGFjZSBpbiAke3RoaXMuX3RleHR9YDtcblxuICAgICAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2UtdHJhc2hcIik7XG5cblxuICAgICAgICB0aGlzLl9vd25lcklkICE9PSB0aGlzLl91c2VySWQgJiZcbiAgICAgICAgICAgICh0aGlzLl9kZWxldGVCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiKTtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICAgICAgdGhpcy5fbGlrZUNvdW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRcIik7XG4gICAgICAgIHRoaXMuX2xpa2VDb3VudC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcblxuICAgICAgICB0aGlzLmlzTGlrZWQoKSAmJiB0aGlzLmxpa2VDYXJkKHRoaXMuX2xpa2VzKTtcblxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICAgIH1cbn0iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9vdmVybGF5Q2xvc2UgPSB0aGlzLl9vdmVybGF5Q2xvc2UuYmluZCh0aGlzKVxuICAgIH1cbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9vdmVybGF5Q2xvc2UpO1xuXG4gICAgfVxuICAgIGNsb3NlKCkge1xuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fb3ZlcmxheUNsb3NlKTtcblxuICAgIH1cbiAgICBfb3ZlcmxheUNsb3NlKGV2dCkge1xuICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpXG4gICAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xvc2UpO1xuICAgIH1cblxufSIsImltcG9ydCB7XG4gICAgUG9wdXBcbn0gZnJvbSBcIi4vUG9wdXBcIjtcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKFBvcHVwU2VsZWN0b3IsIHN1Ym1pdEhhbmRsZXIpIHtcbiAgICAgICAgc3VwZXIoUG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBzdWJtaXRIYW5kbGVyO1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgICAgICAgdGhpcy5faW5wdXRzID0gWy4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIildOztcbiAgICB9XG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuXG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge31cbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG5cbiAgICB9XG4gICAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgICAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuX2lucHV0cylcbiAgICB9XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIH1cbiAgICBjbG9zZSA9ICgpID0+IHtcbiAgICAgICAgc3VwZXIuY2xvc2UoKVxuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpOyAvL3Jlc2V0IHRoZSBmb3JtIHdoZW4gb3Blbm5pbmcgYWdhaW5cblxuICAgIH1cbn0iLCIvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBTZWxlY3RvcnMgLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgaW5wdXROYW1lID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0W25hbWU9J25hbWUnXVwiKTtcbmV4cG9ydCBjb25zdCBpbnB1dFRpdGxlID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0W25hbWU9J3RpdGxlJ11cIik7XG5leHBvcnQgY29uc3QgY2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzXCIpO1xuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTGlzdCA9IGNhcmRzLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLWVkaXQtcHJvZmlsZVwiKTtcbmV4cG9ydCBjb25zdCBwbGFjZVBvcHVwRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm0tdHlwZS1hZGQtcGxhY2VcIik7XG5leHBvcnQgY29uc3QgbmFtZSA9IHBsYWNlUG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtdHlwZS1wbGFjZS1uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHBsYWNlVVJMID0gcGxhY2VQb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dC10eXBlLXBsYWNlLXVybFwiKTtcbmV4cG9ydCBjb25zdCBpbWdQcmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1wcmV2XCIpO1xuZXhwb3J0IGNvbnN0IHBvcHVwUHJldmlld0ltZyA9IGltZ1ByZXZpZXcucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XG5leHBvcnQgY29uc3QgcG9wdXBQcmV2aWV3Q2FwdGlvbiA9IGltZ1ByZXZpZXcucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2FwdGlvblwiKTtcblxuXG5leHBvcnQgY29uc3QgcGxhY2VGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1wbGFjZVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGVTZWxlY3RvciA9IFwiI2NhcmQtdGVtcGxhdGVcIjtcblxuXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZFBvcHVwID0gcHJvZmlsZS5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19jbG9zZS1idXR0b24nKTtcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFt7XG4gICAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICAgIH0sXG5dOyIsImNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycykgPT4ge1xuICAgIHJldHVybiBmZXRjaCh1cmwsIGhlYWRlcnMpXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1c1RleHQpKS5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coKSlcblxufVxuY2xhc3MgQXBpIHtcbiAgICBjb25zdHJ1Y3Rvcih7XG4gICAgICAgIGJhc2VVcmwsXG4gICAgICAgIGhlYWRlcnNcbiAgICB9KSB7XG4gICAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgICB9XG5cbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgICAgfSlcbiAgICB9XG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcbiAgICAgICAgfSlcbiAgICB9XG4gICAgc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dFxuICAgIH0pIHtcblxuICAgICAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICBhYm91dDogYWJvdXQsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgfSlcbiAgICB9XG4gICAgY3JlYXRlQ2FyZChkYXRhKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpXG4gICAgICAgIH0pXG5cbiAgICB9XG4gICAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICAgICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICB9KVxuICAgIH1cbiAgICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coY2FyZElkKVxuICAgICAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZGlzbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgICAgfSlcbiAgICB9XG5cblxuICAgIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXG59XG5cbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIiwgLy9jb2hvcnQtMy1lblxuICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJlZGRlM2E1Yy1iMzBkLTQwYjAtOTllOS02ZjcyZWU5NzZkZGZcIixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICB9XG59KTsiLCIvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBJTVBPUlRTIC8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5pbXBvcnQge1xuICBGb3JtVmFsaWRhdG9yXG59XG5mcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmltcG9ydCB7XG4gIENhcmRcbn0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHtcbiAgUG9wdXBcbn1cbmZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQge1xuICBQb3B1cFdpdGhGb3JtXG59XG5mcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQge1xuICBQb3B1cFdpdGhTdWJtaXRcbn1cbmZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdFwiO1xuaW1wb3J0IHtcbiAgU2VjdGlvblxufSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5cbmltcG9ydCB7XG4gIFVzZXJJbmZvXG59IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5cblxuaW1wb3J0IFwiLi4vc3R5bGVzL2luZGV4LmNzc1wiO1xuaW1wb3J0IHtcbiAgUG9wdXBXaXRoSW1hZ2Vcbn0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcblxuaW1wb3J0IHtcbiAgcHJvZmlsZUZvcm0sXG4gIHByb2ZpbGUsXG4gIHByb2ZpbGVOYW1lLFxuICBwcm9maWxlUG9wdXAsXG4gIHByb2ZpbGVUaXRsZSxcbiAgaW5wdXROYW1lLFxuICBpbnB1dFRpdGxlLFxuICBjYXJkcyxcbiAgY2FyZFRlbXBsYXRlLFxuICBjYXJkTGlzdCxcbiAgcHJvZmlsZUVkaXQsXG4gIHBsYWNlUG9wdXBGb3JtLFxuICBuYW1lLFxuICBwbGFjZVVSTCxcbiAgaW1nUHJldmlldyxcbiAgcG9wdXBQcmV2aWV3SW1nLFxuICBwb3B1cFByZXZpZXdDYXB0aW9uLFxuICBwbGFjZUZvcm0sXG4gIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxuICBlZGl0UHJvZmlsZUJ1dHRvbixcbiAgYWRkQ2FyZFBvcHVwLFxuICBjbG9zZUJ1dHRvbnMsXG4gIGluaXRpYWxDYXJkc1xuXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHNcIlxuaW1wb3J0IHtcbiAgYXBpXG59IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiXG5cblxuXG5jb25zdCBwbGFjZXNTZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICB9LFxuICBcIi5jYXJkc19fbGlzdFwiXG4pO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLyBBUEkgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBjb25zb2xlLmxvZyhhcGkpXG4vLyBhcGkuZ2V0SW5pdGlhbENhcmRzKClcbi8vICAgLnRoZW4ocmVzID0+IHtcbi8vICAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhkYXRhKTtcbi8vICAgICAvLyBjb25zb2xlLmxvZygncmVzJywgcmVzKVxuLy8gICB9KTtcbi8vIGFwaS5nZXRVc2VySW5mbygpLnRoZW4ocmVzID0+IHtcbi8vICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuLy8gICAgIG5hbWU6IHJlcy5uYW1lLFxuLy8gICAgIHRpdGxlOiByZXMuYWJvdXRcbi8vICAgfSlcblxuLy8gfSk7XG5sZXQgdXNlcklkO1xuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKVxuICAudGhlbigoW2NhcmRzLCB1c2VyRGF0YV0pID0+IHtcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XG4gICAgcGxhY2VzU2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcyk7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlQ2FyZChkYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBkYXRhLFxuICAgIGNhcmRUZW1wbGF0ZVNlbGVjdG9yLCB7XG4gICAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEubGluaywgZGF0YS50ZXh0KTtcblxuICAgICAgfSxcbiAgICAgIGhhbmRsZUNhcmREZWxldGU6IChpZCkgPT4ge1xuICAgICAgICBkZWxldGVQb3B1cC5vcGVuKCk7XG5cbiAgICAgICAgZGVsZXRlUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgICAvLyBzdWJtaXQgbW9kYWxcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5kZWxldGVDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIGRlbGV0ZVBvcHVwLmNsb3NlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVMaWtlQ2FyZDogKGlkKSA9PiB7XG4gICAgICAgIC8vbGlrZSBjYXJkXG4gICAgICAgIGlmICghY2FyZC5pc0xpa2VkKCkpIHtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5saWtlQ2FyZChpZClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC5saWtlQ2FyZChyZXMubGlrZXMpO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzJywgcmVzKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcblxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy9kaXNsaWtlIGNhcmRcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5kaXNsaWtlQ2FyZChpZClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC5kaXNsaWtlQ2FyZChyZXMubGlrZXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICAgIHVzZXJJZFxuICApO1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG4gIHJldHVybiBjYXJkRWxlbWVudDtcblxufVxuXG5cblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vIEV2ZW50TGlzdGVuZXJzIC8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGVkaXRQb3B1cC5zZXRJbnB1dFZhbHVlcyhpbmZvKTtcbiAgcHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICBwcm9maWxlRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b24oKTtcbiAgZWRpdFBvcHVwLm9wZW4oKTtcbn0pO1xuXG5hZGRDYXJkUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcG9wdXBBZGRDYXJkLm9wZW4oKTtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcblxufSk7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vIEZvcm0gVmFsaWR0YXRpb24gLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbmNvbnN0IHZhbGlkYXRlQ29uZmlncyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvclwiLFxufTtcblxuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGVDb25maWdzLFxuICBwcm9maWxlUG9wdXBcbik7XG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGVDb25maWdzLCBwbGFjZUZvcm0pO1xuXG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIixcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG59KTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8gUG9wdXAgY3JlYXRpb24gLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXG5cbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXAtcHJldlwiKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwXCIsIChkYXRhKSA9PiB7XG4vLyAgIC8vIGNvbnNvbGUubG9nKCdkYXRhJywgZGF0YSlcbi8vICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YS5uYW1lLCBkYXRhLnRpdGxlKTtcbi8vIH0pO1xuLy8gcG9wdXBFZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cFwiLCAoZGF0YSkgPT4ge1xuICBjb25zb2xlLmxvZygnZGF0YSA9PicsIGRhdGEpXG4gIGFwaVxuICAgIC5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICBhYm91dDogZGF0YS50aXRsZVxuICAgIH0pXG5cbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiBkYXRhLnRpdGxlXG4gICAgICB9KTtcbiAgICAgIGVkaXRQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXG59KTtcbmVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBjb25zdCBwb3B1cEFkZENhcmQgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wb3B1cC1wbGFjZVwiLCAoZGF0YSkgPT4ge1xuLy8gICByZW5kZXJDYXJkKGRhdGEpO1xuLy8gICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuLy8gfSk7XG4vLyBwb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBBZGRDYXJkID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXAtcGxhY2VcIiwgKGRhdGEpID0+IHtcbiAgYXBpXG4gICAgLmNyZWF0ZUNhcmQoZGF0YSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKHJlcyk7XG4gICAgICBwb3B1cEFkZENhcmQuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxufSk7XG5wb3B1cEFkZENhcmQuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5wb3B1cC10eXBlLWRlbGV0ZS1jYXJkXCIpO1xuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8gY2FyZCBjcmVhdGlvbiAvLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cbi8vIHBsYWNlc1NlY3Rpb24ucmVuZGVySXRlbXMoKTtcblxuLy8gZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XG4vLyAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChkYXRhLFxuLy8gICAgIHNlbGVjdG9yLCB7XG5cbi8vICAgICAgIGhhbmRsZUNhcmRDbGljazogKCkgPT4ge1xuLy8gICAgICAgICBwb3B1cEltYWdlLm9wZW4oZGF0YSlcbi8vICAgICAgIH0sXG4vLyAgICAgICBoYW5kbGVDYXJkRGVsZXRlOiAoaWQpID0+IHtcbi8vICAgICAgICAgY29uZmlybU1vZGFsLm9wZW4oKTtcbi8vICAgICAgICAgY29uZmlybU1vZGFsLnNldEFjdGlvbigoKSA9PiB7XG5cbi8vICAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChpZCkudGhlbihyZXMgPT4ge1xuLy8gICAgICAgICAgICAgLy9yZW1vdmUgaXQgZnJvbSBkb21cbi8vICAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuLy8gICAgICAgICAgICAgY29uZmlybU1vZGFsLmNsb3NlKCk7XG4vLyAgICAgICAgICAgfSlcbi8vICAgICAgICAgfSlcbi8vICAgICAgIH1cbi8vICAgICB9LCApXG5cbi8vIH1cblxuXG5cblxuLy8gZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhKSB7XG4vLyAgIGNvbnN0IGVsZW1lbnQgPSBnZW5lcmF0ZUNhcmQoZGF0YSk7XG4vLyAgIHBsYWNlc1NlY3Rpb24uYWRkSXRlbShlbGVtZW50KTtcbi8vIH1cblxuXG5cblxuXG5cbmZ1bmN0aW9uIHJlbmRlckNhcmQoZGF0YSkge1xuICBjb25zdCBlbGVtZW50ID0gZ2VuZXJhdGVDYXJkKGRhdGEpO1xuICBwbGFjZXNTZWN0aW9uLmFkZEl0ZW0oZWxlbWVudCk7XG59IiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHtcbiAgICAgICAgcmVuZGVyZXJcbiAgICB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICAvLyB0aGlzLml0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIH1cbiAgICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgICAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFkZEl0ZW0oaXRlbSkge1xuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgICB9XG59IiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3Rvcih7XG4gICAgICAgIG5hbWVTZWxlY3RvcixcbiAgICAgICAgam9iU2VsZWN0b3IsXG4gICAgICAgIGF2YXRhclNlbGVjdG9yXG4gICAgfSkge1xuICAgICAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcblxuICAgIH1cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxuICAgICAgICAgICAgdGl0bGU6IHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQsXG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0VXNlckluZm8oe1xuICAgICAgICBuYW1lLFxuICAgICAgICBqb2JcbiAgICB9KSB7XG4gICAgICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgdGhpcy5fcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IGpvYjtcbiAgICB9XG4gICAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgICB9XG5cbiAgICBzZXRBdmF0YXJWaXNpYmxlKCkge1xuICAgICAgICB0aGlzLl9hdmF0YXIuc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xuICAgIH1cbn0iLCJpbXBvcnQge1xuICAgIFBvcHVwXG59IGZyb20gXCIuL1BvcHVwXCI7XG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcbiAgICAgICAgdGhpcy5fcG9wdXBDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2NhcHRpb25cIik7XG5cbiAgICB9XG4gICAgb3BlbihpbWFnZSwgdGV4dCkge1xuXG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gaW1hZ2U7XG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gYEEgdmlldyBvZiAke3RleHR9YDtcbiAgICAgICAgdGhpcy5fcG9wdXBDYXB0aW9uLnRleHRDb250ZW50ID0gdGV4dDtcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgIH1cbn0iLCJpbXBvcnQge1xuICAgIFBvcHVwXG59IGZyb20gXCIuL1BvcHVwXCI7XG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xuICAgIHNldEFjdGlvbihhY3Rpb24pIHtcbiAgICAgICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IGFjdGlvbjtcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxufSJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2Zvcm0iLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dCIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNWYWxpZElucHV0cyIsIl9pbnB1dExpc3QiLCJldmVyeSIsIl9zZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfYnV0dG9uIiwidG9nZ2xlQnV0dG9uIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZXNldFZhbGlkYXRpb24iLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsInNlbGVjdG9yIiwidXNlcklkIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlQ2FyZERlbGV0ZSIsImhhbmRsZUxpa2VDYXJkIiwiZG9jdW1lbnQiLCJfc2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2xpa2VCdXR0b24iLCJldnQiLCJfaGFuZGxlTGlrZUNhcmQiLCJfaW1hZ2UiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2lkIiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVDYXJkRGVsZXRlIiwiX3RleHQiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX3VzZXJJZCIsIl9vd25lcklkIiwib3duZXIiLCJfbGlrZXMiLCJsaWtlcyIsImNvbnNvbGUiLCJsb2ciLCJsaWtlQ2FyZCIsIm5ld0xpa2VzIiwiX2xpa2VDb3VudCIsImxlbmd0aCIsImRpc2xpa2VDYXJkIiwiaXNMaWtlZCIsInNvbWUiLCJsaWtlIiwicmVtb3ZlQ2FyZCIsIl9lbGVtZW50IiwiZ2VuZXJhdGVDYXJkIiwiX2dldENsb25lRnJvbVRlbXBsYXRlIiwic3JjIiwiYWx0Iiwic3R5bGUiLCJkaXNwbGF5IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsImNsb3NlIiwiYmluZCIsIl9oYW5kbGVFc2NDbG9zZSIsIl9vdmVybGF5Q2xvc2UiLCJrZXkiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImNvbnRhaW5zIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiUG9wdXBTZWxlY3RvciIsInN1Ym1pdEhhbmRsZXIiLCJzdXBlciIsIl9mb3JtRWxlbWVudCIsInJlc2V0IiwiX3N1Ym1pdEhhbmRsZXIiLCJfaW5wdXRzIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwicHJvZmlsZSIsInByb2ZpbGVQb3B1cCIsImNhcmRzIiwiZm9ybSIsInBsYWNlUG9wdXBGb3JtIiwiaW1nUHJldmlldyIsInBsYWNlRm9ybSIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkQ2FyZFBvcHVwIiwiY3VzdG9tRmV0Y2giLCJ1cmwiLCJoZWFkZXJzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJjYXRjaCIsImVyciIsImFwaSIsImJhc2VVcmwiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjcmVhdGVDYXJkIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImF1dGhvcml6YXRpb24iLCJwbGFjZXNTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwicmVuZGVyQ2FyZCIsImFsbCIsInVzZXJEYXRhIiwidXNlckluZm8iLCJpbmZvIiwiZWRpdFBvcHVwIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJwb3B1cEFkZENhcmQiLCJhZGRGb3JtVmFsaWRhdG9yIiwidmFsaWRhdGVDb25maWdzIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiX2F2YXRhciIsInRpdGxlIiwiam9iIiwic2V0VXNlckF2YXRhciIsImF2YXRhciIsInNldEF2YXRhclZpc2libGUiLCJ2aXNpYmlsaXR5IiwiaW1hZ2VQb3B1cCIsIl9wb3B1cEltYWdlIiwiX3BvcHVwQ2FwdGlvbiIsImltYWdlIiwidGV4dCIsImRlbGV0ZVBvcHVwIiwic2V0QWN0aW9uIiwiYWN0aW9uIiwiZWxlbWVudCIsImNhcmQiXSwic291cmNlUm9vdCI6IiJ9